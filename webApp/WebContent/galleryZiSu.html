<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style>
	#main{width:800px;height:overflow;margin:0 auto; background-color:#0f0;}
	img{width:100px;height:100px;margin :5px 5px;float:left;}
	#bg{display:none; width:100vW; height:100vh; position : fixed; top:0; background-color:rgb(0,0,0,0.5);
	}
	#popup{position:absolute;border:2px solid black;width:300px;height:325px;
	margin:0 auto;text-align:center;background-color:lightgray;
	}
	
</style>
<script>
	var tag="";
	var popup;
	function setImg(){
		
		var imgList=['1_1.jpg','2_1.jpg','3_1.jpg','4_1.jpg','5_1.jpg','6_1.jpg',
			'7_1.jpg','8_1.jpg','9_1.jpg','10_1.jpg','nong.gif','ogu.gif','riaun.gif'];
		
		for(var j=0;j<=5;j++){
			for(var i=1;i<imgList.length;i++){
				
				tag+="<div><img src='"+imgList[i]+"' onclick='setPopupPosition();showPop(this.src);'/></div>";
			}
		}
		document.getElementById("main").innerHTML =tag;
	}
	var eventX,eventY, divX, divY, moveX, moveY, flag=false;
	//팝업 div 보여줄 위치 설정
	function setPopupPosition(){
		eventX = event.clientX;//이벤트가 발생한 좌표
		eventY= event.clientY;
		//팝업 div 좌표 찍어주기 
		//팝업 width : 300px 
		popup=document.getElementById("popup").style;
		
		popup.left=eventX-151+"px";
		popup.top=eventY+"px";
	}
	var popTag="";
	function showPop(imgsrc){
		var imgsrcLength = imgsrc.length;
		var lastslice =imgsrc.lastIndexOf('/'); //이미지명을 얻기 위해 마지막 위치 구하기
		var imgname = imgsrc.substring(lastslice+1,imgsrcLength);//아이고 파일 이름 구하기 참 힘들다,,
		popTag+="<div style='height:25px' onmousedown='setMoveStart();'>"+imgname+"</div>";
		popTag+="<img style='margin:0 auto;padding:0;width:300px;height:300px;' src='"+imgname+"'onclick='closePopup()'/>";
		document.getElementById("popup").innerHTML=popTag;
		document.getElementById("bg").style.display="block";
	}
	//드래그 시작 
	function setMoveStart(){
		//드래그시작
		flag=true;
		//마우스를 누르면 이벤트가 발생한곳 의 x,y좌표를 구한다.
		eventX = event.clientX;
		eventY= event.clientY;
		//팝업창의 좌표 구하기
		divX = parseInt(popup.left);//픽셀단위가 생겨 제거하기위해 정수로 바꿔줘야한다.
		divY = parseInt(popup.top);
		console.log('eventX->', eventX,'eventY->', eventY);
		console.log('divX->',divX,'divY->',divY);
		
		//마우스를 이동하면 이동한 곳은 이벤트 X,y 좌표를 구한다.
		document.onmousemove = setMouseDrag;//클릭후 -> 움직이면 아래 함수를 실행해라
	}
	function setMouseDrag(){
		if(flag){
			moveX = event.clientX;
			moveY = event.clientY;
			//나중에 발생한 이벤트 좌표 - 이전에 발생한 이벤트 좌표  =이동할 거리
			var x = moveX-eventX;
			var y = moveY-eventY;
			//팝업이동하기
			popup.left=divX+x+"px";
			popup.top=divY+y+"px";
		}
	}
	function setFlag(){
		flag =false;
	}
	function closePopup(){
		document.getElementById("bg").style.display="none";
		popTag="";
	}
	document.onmouseup =setFlag;//마우스를 떼면
</script>
</head>
<body onload='setImg()'>
<div id ="bg">
	<div id="popup"></div>
</div>

 
<div id="main"></div>
</body>
</html>